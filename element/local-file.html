<link rel="import" href="../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../element/shared-style.html">

<dom-module id="local-file">
    <template>
        <style include="shared-style"></style>
        <style>
            paper-menu {
                background-color: #d6e0ef;
            }
        </style>

        <iron-ajax url="{{url}}" last-response="{{data}}" auto></iron-ajax>

        <paper-menu selected="{{_selectedIndex}}">
            <template is="dom-repeat" items="{{data.list}}" as="item">
                <paper-item>
                    <span>{{item.title}}</span>
                </paper-item>
            </template>
        </paper-menu>

        <paper-item on-tap="addNewFile">
            <span>Add</span>
        </paper-item>

        <array-selector id="selector" items="{{data.list}}" selected="{{selectedFile}}"></array-selector>

        <!--<array-selector id="selector" items="{{files}}" selected-item="{{selected}}"></array-selector>-->

    </template>
    <script>
        Polymer({
            is: 'local-file',
            properties: {
                url: {
                    type: String,
                    value: "./data/file_list.json"
                },
                data: {
                    type: Object,
                    notify: true
                },
                /*
                files: {
                    type: Array,
                    computed: 'getFileList(data)'
                },
                */
                _selectedIndex: {
                    observer: '_selectedIndexChanged'
                },
                selectedFile: {
                    notify: true    // should declared for upper element
                }
            },
/*
            getFileList: function (data) {
                return data.list;
            },
*/
            _selectedIndexChanged: function(idx) {
/*
                console.log(idx, this.data.list[idx]);
                this.$.selector.select(this.files[idx]);
*/
                this.$.selector.select(this.data.list[idx]);
            },
            addNewFile: function (e) {
                this.push('data.list', { title: '1', text: '2' });
            }
        });
    </script>
</dom-module>